#!/usr/bin/env node
const {summarizeHtml} = require('..')

function readToEnd(stream, callback) {
  const chunks = []
  return stream
  .on('error', callback)
  .on('data', chunk => chunks.push(chunk))
  .on('end', () => callback(null, chunks))
}

function main(callback) {
  readToEnd(process.stdin, (error, chunks) => {
    if (error) return callback(error)

    const inputHtml = chunks.join(' ')
    summarizeHtml(inputHtml, 25, (error, result) => {
      if (error) return callback(error)

      console.log(result)
      callback()
    })
  })
}

main((error) => {
  if (error) {
    console.error(error.toString())
    process.exit(1)
  }
  process.exit(0)
})
