#!/usr/bin/env node
var summarizeHtml = require('..').summarizeHtml;

function readToEnd(stream, callback) {
  var chunks = [];
  return stream
    .on('error', callback)
    .on('data', function(chunk) { return chunks.push(chunk); })
    .on('end', function() { return callback(null, chunks); });
}

function main(callback) {
  readToEnd(process.stdin, function(error, chunks) {
    if (error) return callback(error);

    var inputHtml = chunks.join(' ');
    summarizeHtml(inputHtml, 25, function(error, result) {
      if (error) return callback(error);

      console.log(result);
      callback();
    });
  });
}

main(function(error) {
  if (error) {
    console.error(error.toString());
    process.exit(1);
  }
  process.exit(0);
});
